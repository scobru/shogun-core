rules:
  - id: owasp.generic.dangerous-eval
    patterns:
      - pattern: eval(...)
    message: Avoid eval; it can lead to code injection.
    severity: ERROR
    languages: [javascript, typescript]
  - id: owasp.generic.weak-random
    patterns:
      - pattern: Math.random()
    message: Avoid Math.random for security sensitive operations.
    severity: WARNING
    languages: [javascript, typescript]
  - id: owasp.oauth.client-secret-in-browser
    patterns:
      - pattern-inside: |
          const $CONF = {...}
      - pattern: 'clientSecret: $SECRET'
    message: Do not embed OAuth client secrets in browser configs.
    severity: ERROR
    languages: [javascript, typescript]
  - id: webauthn.insecure-rp-id
    pattern: 'rpId: "localhost"'
    message: WebAuthn rpId should match your production origin (avoid hardcoding to localhost).
    severity: WARNING
    languages: [javascript, typescript]
