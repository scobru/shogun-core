  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.warn
    [webauthnPlugin] WebAuthn plugin disabled - not in browser environment

    [0m [90m 42 |[39m     [90m// Verifica se siamo in ambiente browser[39m
     [90m 43 |[39m     [36mif[39m ([36mtypeof[39m window [33m===[39m [32m'undefined'[39m) {
    [31m[1m>[22m[39m[90m 44 |[39m       console[33m.[39mwarn(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 45 |[39m         [32m'[webauthnPlugin] WebAuthn plugin disabled - not in browser environment'[39m[33m,[39m
     [90m 46 |[39m       )[33m;[39m
     [90m 47 |[39m       [36mreturn[39m[33m;[39m[0m

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:44:15)
      at Object.<anonymous> (src/__tests__/plugins/webauthn/webauthnPlugin.test.ts:96:12)

  console.warn
    [webauthnPlugin] WebAuthn not supported in this environment

    [0m [90m 50 |[39m     [90m// Verifica se WebAuthn â”œÂ¿ supportato[39m
     [90m 51 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39misSupported()) {
    [31m[1m>[22m[39m[90m 52 |[39m       console[33m.[39mwarn(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 53 |[39m         [32m'[webauthnPlugin] WebAuthn not supported in this environment'[39m[33m,[39m
     [90m 54 |[39m       )[33m;[39m
     [90m 55 |[39m       [36mreturn[39m[33m;[39m[0m

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:52:15)
      at Object.<anonymous> (src/__tests__/plugins/webauthn/webauthnPlugin.test.ts:96:12)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.warn
    [webauthnPlugin] WebAuthn plugin disabled - not in browser environment

    [0m [90m 42 |[39m     [90m// Verifica se siamo in ambiente browser[39m
     [90m 43 |[39m     [36mif[39m ([36mtypeof[39m window [33m===[39m [32m'undefined'[39m) {
    [31m[1m>[22m[39m[90m 44 |[39m       console[33m.[39mwarn(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 45 |[39m         [32m'[webauthnPlugin] WebAuthn plugin disabled - not in browser environment'[39m[33m,[39m
     [90m 46 |[39m       )[33m;[39m
     [90m 47 |[39m       [36mreturn[39m[33m;[39m[0m

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:44:15)
      at Object.<anonymous> (src/__tests__/plugins/webauthn/webauthnPlugin.test.ts:96:12)

  console.warn
    [webauthnPlugin] WebAuthn not supported in this environment

    [0m [90m 50 |[39m     [90m// Verifica se WebAuthn â”œÂ¿ supportato[39m
     [90m 51 |[39m     [36mif[39m ([33m![39m[36mthis[39m[33m.[39misSupported()) {
    [31m[1m>[22m[39m[90m 52 |[39m       console[33m.[39mwarn(
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 53 |[39m         [32m'[webauthnPlugin] WebAuthn not supported in this environment'[39m[33m,[39m
     [90m 54 |[39m       )[33m;[39m
     [90m 55 |[39m       [36mreturn[39m[33m;[39m[0m

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:52:15)
      at Object.<anonymous> (src/__tests__/plugins/webauthn/webauthnPlugin.test.ts:96:12)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.error
    Error during WebAuthn login: Error: WebAuthn verification failed

    [0m [90m 507 |[39m       [36mreturn[39m [36mawait[39m core[33m.[39mlogin(username[33m,[39m [32m''[39m[33m,[39m credentials[33m.[39mkey)[33m;[39m
     [90m 508 |[39m     } [36mcatch[39m (error[33m:[39m any) {
    [31m[1m>[22m[39m[90m 509 |[39m       console[33m.[39merror([32m`Error during WebAuthn login: ${error}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 510 |[39m       [90m// Log but do not depend on handler return value[39m
     [90m 511 |[39m       [33mErrorHandler[39m[33m.[39mhandle(
     [90m 512 |[39m         [33mErrorType[39m[33m.[39m[33mWEBAUTHN[39m[33m,[39m[0m

      at WebauthnPlugin.<anonymous> (src/plugins/webauthn/webauthnPlugin.ts:509:15)
      at fulfilled (src/plugins/webauthn/webauthnPlugin.ts:5:58)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.error
    Error during WebAuthn login: Error: WebAuthn verification failed

    [0m [90m 507 |[39m       [36mreturn[39m [36mawait[39m core[33m.[39mlogin(username[33m,[39m [32m''[39m[33m,[39m credentials[33m.[39mkey)[33m;[39m
     [90m 508 |[39m     } [36mcatch[39m (error[33m:[39m any) {
    [31m[1m>[22m[39m[90m 509 |[39m       console[33m.[39merror([32m`Error during WebAuthn login: ${error}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 510 |[39m       [90m// Log but do not depend on handler return value[39m
     [90m 511 |[39m       [33mErrorHandler[39m[33m.[39mhandle(
     [90m 512 |[39m         [33mErrorType[39m[33m.[39m[33mWEBAUTHN[39m[33m,[39m[0m

      at WebauthnPlugin.<anonymous> (src/plugins/webauthn/webauthnPlugin.ts:509:15)
      at fulfilled (src/plugins/webauthn/webauthnPlugin.ts:5:58)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.error
    Error during WebAuthn registration: TypeError: Cannot read properties of undefined (reading 'success')

    [0m [90m 636 |[39m       [36mreturn[39m result[33m;[39m
     [90m 637 |[39m     } [36mcatch[39m (error[33m:[39m any) {
    [31m[1m>[22m[39m[90m 638 |[39m       console[33m.[39merror([32m`Error during WebAuthn registration: ${error}`[39m)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 639 |[39m       [33mErrorHandler[39m[33m.[39mhandle(
     [90m 640 |[39m         [33mErrorType[39m[33m.[39m[33mWEBAUTHN[39m[33m,[39m
     [90m 641 |[39m         [32m'WEBAUTHN_SIGNUP_ERROR'[39m[33m,[39m[0m

      at WebauthnPlugin.<anonymous> (src/plugins/webauthn/webauthnPlugin.ts:638:15)
      at fulfilled (src/plugins/webauthn/webauthnPlugin.ts:5:58)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

  console.log
    [webauthnPlugin] WebAuthn plugin initialized with signer support

      at WebauthnPlugin.initialize (src/plugins/webauthn/webauthnPlugin.ts:62:13)

FAIL src/__tests__/plugins/webauthn/webauthnPlugin.test.ts
  Ã”ÃªÃœ dummy test (5 ms)
  WebauthnPlugin
    Constructor
      Ã”ÃªÃœ should create WebauthnPlugin with correct properties (25 ms)
    isSupported
      Ã”ÃªÃœ should return false when not in browser environment (3 ms)
      Ã”ÃªÃœ should return false when PublicKeyCredential not available (11 ms)
      Ã”ÃªÃœ should return true when WebAuthn is supported (4 ms)
    initialize
      Ã”ÃªÃœ should initialize plugin when WebAuthn is supported (4 ms)
      Ã”ÃªÃœ should not initialize when not in browser environment (2 ms)
      Ã”ÃªÃœ should not initialize when WebAuthn not supported (5 ms)
    destroy
      Ã”ÃªÃœ should cleanup resources when destroyed (6 ms)
    generateCredentials
      Ã”ÃªÃœ should generate credentials successfully (3 ms)
      Ã”ÃªÃœ should generate credentials with existing credential (3 ms)
    createAccount
      Ã”ÃªÃœ should create account successfully (3 ms)
    authenticateUser
      Ã”ÃªÃœ should authenticate user successfully (3 ms)
    abortAuthentication
      Ã”ÃªÃœ should abort authentication (8 ms)
    removeDevice
      Ã”ÃªÃœ should remove device successfully (3 ms)
    createSigningCredential
      Ã”ÃªÃœ should create signing credential successfully (3 ms)
    createAuthenticator
      Ã”ÃªÃœ should create authenticator function (3 ms)
    createDerivedKeyPair
      Ã”ÃªÃœ should create derived key pair (3 ms)
    signWithDerivedKeys
      Ã”ÃªÃœ should sign data with derived keys (3 ms)
    getSigningCredential
      Ã”ÃªÃœ should return signing credential if exists (3 ms)
      Ã”ÃªÃœ should return undefined if credential not found (3 ms)
    listSigningCredentials
      Ã”ÃªÃœ should return list of signing credentials (2 ms)
    removeSigningCredential
      Ã”ÃªÃœ should remove signing credential successfully (2 ms)
      Ã”ÃªÃœ should return false if credential not found (3 ms)
    createGunUserFromSigningCredential
      Ã”ÃªÃœ should create Gun user successfully (2 ms)
      Ã”ÃªÃœ should handle Gun user creation failure (2 ms)
    getGunUserPubFromSigningCredential
      Ã”ÃªÃœ should return Gun user public key (3 ms)
      Ã”ÃªÃœ should return undefined if not found (3 ms)
    getHashedCredentialId
      Ã”ÃªÃœ should return hashed credential ID (2 ms)
      Ã”ÃªÃœ should return undefined if not found (2 ms)
    verifyConsistency
      Ã”ÃªÃœ should verify consistency successfully (3 ms)
      Ã”ÃªÃœ should detect inconsistency (2 ms)
    setupConsistentOneshotSigning
      Ã”ÃªÃœ should setup consistent oneshot signing (3 ms)
    login
      â”œÃ¹ should perform login successfully (9 ms)
      Ã”ÃªÃœ should handle login failure (5 ms)
    signUp
      â”œÃ¹ should perform signup successfully (5 ms)
    Error handling
      Ã”ÃªÃœ should handle webauthn initialization errors (8 ms)
      Ã”ÃªÃœ should handle signer initialization errors (3 ms)

  Ã”Ã¹Ã… WebauthnPlugin Ã”Ã‡â•‘ login Ã”Ã‡â•‘ should perform login successfully

    expect(received).toEqual(expected) // deep equality

    - Expected  - 5
    + Received  + 2

      Object {
    -   "success": true,
    -   "user": Object {
    -     "id": "testuser",
    -     "username": "testuser",
    -   },
    +   "error": "WebAuthn verification failed",
    +   "success": false,
      }

      918 |       const result = await plugin.login('testuser');
      919 |
    > 920 |       expect(result).toEqual(mockAuthResult);
          |                      ^
      921 |     });
      922 |
      923 |     it('should handle login failure', async () => {

      at src/__tests__/plugins/webauthn/webauthnPlugin.test.ts:920:22
      at fulfilled (src/__tests__/plugins/webauthn/webauthnPlugin.test.ts:5:58)

  Ã”Ã¹Ã… WebauthnPlugin Ã”Ã‡â•‘ signUp Ã”Ã‡â•‘ should perform signup successfully

    expect(received).toEqual(expected) // deep equality

    - Expected  - 5
    + Received  + 2

      Object {
    -   "success": true,
    -   "user": Object {
    -     "id": "testuser",
    -     "username": "testuser",
    -   },
    +   "error": "Cannot read properties of undefined (reading 'success')",
    +   "success": false,
      }

      1000 |       });
      1001 |
    > 1002 |       expect(result).toEqual(mockSignUpResult);
           |                      ^
      1003 |     });
      1004 |   });
      1005 |

      at src/__tests__/plugins/webauthn/webauthnPlugin.test.ts:1002:22
      at fulfilled (src/__tests__/plugins/webauthn/webauthnPlugin.test.ts:5:58)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 36 passed, 38 total
Snapshots:   0 total
Time:        0.892 s, estimated 2 s
Ran all test suites matching /src\\__tests__\\plugins\\webauthn\\webauthnPlugin.test.ts/i.
