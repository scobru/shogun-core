<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ShogunCore Vanilla Test</title>
    <style>
      body {
        font-family: monospace;
        background: #f8f8f8;
        color: #222;
        padding: 2em;
      }

      pre {
        background: #fff;
        border: 1px solid #ccc;
        padding: 1em;
      }

      .ok {
        color: green;
      }

      .fail {
        color: red;
      }
    </style>
  </head>

  <body>
    <h1>ShogunCore Vanilla Test</h1>
    <pre id="output">Loading...</pre>
    <!-- Load Gun.js first -->
    <script src="https://cdn.jsdelivr.net/npm/gun@0.2020.1237/dist/gun.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gun@0.2020.1237/dist/sea.js"></script>
    <script src="../dist/browser/shogun-core.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/shogun-relays@1.0.3/browser.js"></script>
    <script type="module">
      function log(msg, cls) {
        const el = document.getElementById("output");
        el.innerHTML += `<div class="${cls || ""}">${msg}</div>`;
      }
      document.getElementById("output").textContent = "";

      // Check if ShogunRelays is available

      log("✓ <b>ShogunRelays</b> loaded successfully", "ok");

      log("✓ <b>ShogunCore</b> found on window", "ok");

      const gun = Gun({ localStorage: true, peers: await window.ShogunRelays.getRelays() });
      
      const config = {
        gunInstance: gun,
      };

      const shogun = window.Shogun(config);

      if (window !== undefined && shogun !== undefined) {
        window.gun = shogun?.gun ?? null;
        window.shogun = shogun ?? null;
        console.log(shogun);
        console.log(shogun.gun);
      }
    </script>
  </body>
</html>
